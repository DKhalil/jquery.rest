(function(){"use strict";var a,b,c,d,e,f,g,h,i,j,k,l;g=function(a){throw new Error("ERROR: jquery.rest: "+a)},i=function(a){var b;for(b="";a-- >0;)b+="  ";return b},f=function(a){return window.btoa||g("You need a polyfill for 'btoa' to use basic auth."),window.btoa(a)},j=function(a){return window.JSON||g("You need a polyfill for 'JSON' to use stringify."),window.JSON.stringify(a)},h=function(a,b){var c;return c=function(){},c.prototype=a,$.extend(!0,new c,b)},k=function(a){return a&&$.isPlainObject(a)?($.each(a,function(a){return void 0===d[a]?g("Unknown option: '"+a+"'"):void 0}),null):!1},l=function(a,b){return"string"!==$.type(b)?g("'"+a+"' must be a string"):void 0},e=function(){return alert('"delete()" has been deprecated. Please use "destroy()" or "del()" instead.')},d={url:"",cache:0,request:function(a,b){return $.ajax(b)},isSingle:!1,autoClearCache:!0,cachableMethods:["GET"],methodOverride:!1,stringifyData:!1,stripTrailingSlash:!1,password:null,username:null,verbs:{create:"POST",read:"GET",update:"PUT",destroy:"DELETE"},ajax:{dataType:"json"}},a=function(){function a(a){this.parent=a,this.c={}}return a.prototype.valid=function(a){var b;return b=(new Date).getTime()-a.getTime(),b<=1e3*this.parent.opts.cache},a.prototype.key=function(a){var b;return b="",$.each(a,function(a){return function(c,d){return b+=c+"="+($.isPlainObject(d)?"{"+a.key(d)+"}":d)+"|"}}(this)),b},a.prototype.get=function(a){var b;return(b=this.c[a])&&this.valid(b.created)?$.when(JSON.parse(JSON.stringify(b.data))):void 0},a.prototype.put=function(a,b){return b=JSON.parse(JSON.stringify(b.responseJSON)),this.c[a]={created:new Date,data:b}},a.prototype.clear=function(a){return a?$.each(this.c,function(b){return function(c){return c.match(a)?delete b.c[c]:void 0}}(this)):this.c={}},a}(),c=function(){function a(a,b,c,e){this.name=a,this.method=b,null==c&&(c={}),this.parent=e,l("name",this.name),l("method",this.method),k(c),this.parent[this.name]&&g("Cannot add Verb: '"+name+"' already exists"),this.method=this.method.toUpperCase(),c.url||(c.url=""),this.opts=h(this.parent.opts,c),this.root=this.parent.root,this.custom=!d.verbs[this.name],this.call=$.proxy(this.call,this),this.call.instance=this}return a.prototype.call=function(){var a,b,c;return b=this.parent.extractUrlData(this.method,arguments),c=b.url,a=b.data,this.custom&&(c+=this.opts.url||this.name),this.parent.ajax.call(this,this.method,c,a)},a.prototype.show=function(a){return console.log(i(a)+this.name+": "+this.method)},a}(),b=function(){function b(a,c,d){null==c&&(c={}),k(c),d&&d instanceof b?(this.name=a,l("name",this.name),this.constructChild(d,c)):(this.url=a||"",l("url",this.url),this.constructRoot(c))}return b.prototype.constructRoot=function(b){return this.opts=h(d,b),this.root=this,this.expectedIds=0,this.urlNoId=this.url,this.cache=new a(this),this.parent=null,this.name=this.opts.name||"ROOT"},b.prototype.constructChild=function(a,c){return this.parent=a,l("name",this.name),this.parent instanceof b||this.error("Invalid parent"),this.parent[this.name]&&this.error("'"+name+"' already exists"),c.url||(c.url=""),this.opts=h(this.parent.opts,c),this.opts.isSingle="isSingle"in c&&c.isSingle,this.root=this.parent.root,this.urlNoId=this.parent.url+((this.opts.url||this.name)+"/"),this.url=this.urlNoId,this.expectedIds=this.parent.expectedIds,this.opts.isSingle||(this.expectedIds+=1,this.url+=":ID_"+this.expectedIds+"/"),$.each(this.opts.verbs,$.proxy(this.addVerb,this)),this.destroy?(this.del=this.destroy,this["delete"]=e):void 0},b.prototype.error=function(a){return g("Cannot add Resource: "+a)},b.prototype.add=function(a,c){return this[a]=new b(a,c,this)},b.prototype.addVerb=function(a,b,d){return this[a]=new c(a,b,d,this).call},b.prototype.show=function(a){return null==a&&(a=0),a>25&&g("Plugin Bug! Recursion Fail"),this.name&&console.log(i(a)+this.name+": "+this.url),$.each(this,function(b,d){return"function"===$.type(d)&&d.instance instanceof c&&"del"!==b?d.instance.show(a+1):void 0}),$.each(this,function(c,d){return"parent"!==c&&"root"!==c&&d instanceof b?d.show(a+1):void 0}),null},b.prototype.toString=function(){return this.name},b.prototype.extractUrlData=function(a,b){var c,d,e,f,h,i,j,k,l,m,n,o,p,q,r,s;for(j=[],f=null,p=null,k=0,m=b.length;m>k;k++)c=b[k],r=$.type(c),"string"===r||"number"===r?j.push(c):"object"===r&&null===f?f=c:"object"===r&&null===p?p=c:g("Invalid argument: "+c+" ("+this[a]+(": "+r+").")+" Must be strings or ints (IDs) followed by one optional object and one optional query params object.");for(q=j.length,d="create"!==a,e="update"!==a&&"delete"!==a,s=null,d&&q===this.expectedIds&&(s=this.url),e&&q===this.expectedIds-1&&(s=this.urlNoId),null===s&&(e&&(o=this.expectedIds-1),d&&(o=(o?o+" or ":"")+this.expectedIds),g("Invalid number of ID arguments, required "+o+", provided "+q)),h=l=0,n=j.length;n>l;h=++l)i=j[h],s=s.replace(new RegExp("/:ID_"+(h+1)+"/"),"/"+i+"/");return p&&(s+="?"+$.param(p)),{url:s,data:f}},b.prototype.ajax=function(a,b,c){var d,e,h,i,k,l,m;return a||g("method missing"),b||g("url missing"),i={},this.opts.username&&this.opts.password&&(e=f(this.opts.username+":"+this.opts.password),i.Authorization="Basic "+e),c&&this.opts.stringifyData&&"GET"!==a&&"HEAD"!==a&&(c=j(c),i["Content-Type"]="application/json"),this.opts.methodOverride&&"GET"!==a&&"HEAD"!==a&&"POST"!==a&&(i["X-HTTP-Method-Override"]=a,a="POST"),this.opts.stripTrailingSlash&&(b=b.replace(/\/$/,"")),d={url:b,type:a,headers:i},c&&(d.data=c),d=$.extend(!0,{},this.opts.ajax,d),m=this.opts.cache&&$.inArray(a,this.opts.cachableMethods)>=0,m&&(k=this.root.cache.key(d),l=this.root.cache.get(k))?l:(this.opts.cache&&this.opts.autoClearCache&&-1===$.inArray(a,this.opts.cachableMethods)&&(h=b.replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1"),this.root.cache.clear(new RegExp(h))),l=this.opts.request(this.parent,d),m&&l.done(function(a){return function(){return a.root.cache.put(k,l)}}(this)),l)},b}(),b.defaults=d,$.RestClient=b}).call(this);
//# sourceMappingURL=jquery.rest.min.js.map